<!DOCTYPE html>
<html>
    <body>
        <p>Universal RPC client</p>
        <p>
            Create an app
            <a href="https://discord.com/developers/applications" target="_blank">here</a> and copy
            the client ID
        </p>
        <p>Please enter that client ID below</p>
        <form>
            <label for="clientId">Client Id:</label>
            <input type="text" id="clientId" name="clientId" />
            <br />
            <input type="submit" />
            <div id="reply"></div>
        </form>
        <script>
            const { ipcRenderer, ipcMain, shell } = require('electron');

            document.addEventListener('click', function (event) {
                if (event.target.tagName === 'A' && event.target.href.startsWith('http')) {
                    event.preventDefault();
                    shell.openExternal(event.target.href);
                }
            });

            const form = document.querySelector('form');
            form.addEventListener('submit', submitForm);

            function submitForm(e) {
                e.preventDefault();

                const clientId = document.querySelector('#clientId').value;
                ipcRenderer.send('clientId:value', clientId);

                ipcRenderer.on('asynchronous-reply', (event, arg) => {
                    let replyDiv = document.querySelector('#reply');

                    if (arg.success === true) {
                        replyDiv.innerHTML = 'Success!';
                    } else {
                        replyDiv.innerHTML = `There was an error! Please enter a valid client ID: ${arg.error}`;
                    }
                });
            }
        </script>
    </body>
</html>
